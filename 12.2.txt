.\.venv\Scripts\activate

python src/main.py

python -m pytest tests/test_trade_manager.py -v

주요 변경사항:
주문 실행 전에 현재 포지션 확인
활성화된 포지션이 있으면 주문 실행하지 않고 메시지 전송
레버리지 설정 에러 처리 개선
이렇게 하면:
포지션이 있을 때는 명확한 메시지로 알려주고
새로운 주문을 실행하지 않아 위험을 방지할 수 있습니다
실제 트레이딩에서는 이런 상황에서:
현재 포지션 방향과 새로운 신호 방향 비교
포지션 크기 조정 가능 여부 확인
부분 청산 후 새로운 진입 등의 전략을 구현할 수 있습니다.

기존 버전에서는 잘 동작하는데 새 버전에서 서명 오류가 발생
에러 메시지를 보면 서명 문자열 형식이 다름:
error sign! origin_string[1739430411247FLbWUu1Gr50KNIllm520000{"category": "linear", "symbol": "BTCUSDT", "buyLeverage": "5", "sellLeverage": "5", "timestamp": "1739430411247"}]
기존 코드와 비교해보면:
기존 코드는 _request 메서드에서:
if method == "GET":
    query_string = '&'.join([f"{k}={v}" for k, v in sorted(request_params.items())])
    sign_payload = timestamp + self.api_key + recv_window + query_string
else:
    sign_payload = timestamp + self.api_key + recv_window + json.dumps(request_params)
현재 코드는:
if method == 'POST':
    param_str = json.dumps(sorted_params)
else:
    param_str = '&'.join([f"{k}={v}" for k, v in sorted_params.items()])
서명 생성 방식이 다르네요. 내일 기존 코드의 서명 생성 방식으로 돌아가는 것이 좋을 것 같습니다.